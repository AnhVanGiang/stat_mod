---
title: "Assignment 1"
output: pdf_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(afex)
library(performance)
library(magrittr)
library(plyr)
```

## Question 4

### a) Using the parametrization $\mu = 0$:

``` {r, echo=TRUE}

data("iris");

Y <- iris[order(iris$Species), "Sepal.Width"];

X <- diag(3) %x% rep(1, 50);

```
Then we calculate the estimated $\hat{\beta} = (X^TX )^{-1}X^T Y$ as

``` {r, echo=TRUE}

beta = (t(X) %*% X) %>% solve() %*% t(X) %*% Y;

```

The residual sum of squares $S_{\Omega}$ and $S_{\omega}$ of the full and reduced
models respectively are 

```{r, echo=TRUE}

s1 = norm(Y - X %*% beta)^2;
s2 = norm(Y - matrix(rep(1, 150),ncol=1) * mean(Y))^2;
```
The unbiased estimator of $\sigma^2$ are $\frac{S_{\Omega}}{n - 1} =  `r s1`$
and $\frac{S_{\omega}}{n - 1} =  `r s2`$.
```{r, echo=TRUE}
unb_est = s1/(150 - 1);


```
